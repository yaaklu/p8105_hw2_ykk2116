---
title: "P8105_hw2_ykk2116"
author: "Yaa Asantewaa Klu"
date: "10/1/2018"
output: html_document
---

### Problem 1

Loading tidyverse, accessing data file and reading/cleaning dataset
```{r}
library(tidyverse) 

nyc_subway = read_csv(file =  "./data/NYC_Transit_Subway_Entrance_And_Exit_Data (1).csv") %>%
janitor::clean_names(dat = .) %>%
select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada) %>%
mutate(entry = recode(entry, "YES" =  TRUE, "NO" = FALSE))
```

_The dataset contains information on the subway stations and railway tracks in New York City. The variables in the dataset include the different railway lines, the names of the stations, the directions of the railway lines in terms of longitudes and latitudes, the routes used, information on vending accessibility and information on their ADA compliance._ 

_Using the code chunk above, the variable names were cleaned by turning them into lowercase letters, and spaces between the variable names were replaced with underscores. The code also selects the specific variables as instructed and the entry variable was also chagned from a factor into a logical variable._

_The dataset has `r nrow(nyc_subway)` rows and `r ncol(nyc_subway)` columns. At this point the dataset is not entirely tidy because input for route are spread across 11 different columns and also the route number is part of the variable name of route._


Distinct stations, stations which are ADA complaint 
```{r}
unique_stations = distinct(nyc_subway, line, station_name, ada)

nrow(unique_stations)

sum(unique_stations$ada)
```
_There are `r nrow(nyc_subway)` distinct stations and `r sum(unique_stations$ada)` of these distinct stations are ADA compliant._

Stations without vending, but with entrance/exits. 
```{r}
entry_vending = nyc_subway %>%
mutate(vending = recode(vending, "YES" = TRUE, "NO" = FALSE),
       entry_no_vending = !(vending == entry))
sum(entry_vending$entry_no_vending)/nrow(entry_vending)       
```
_There proportion of stations with entrance/exits but with no vending is `r sum(entry_vending$entry_no_vending)/nrow(entry_vending)`._

Reformatted data so that route number and route name are distinct variables
```{r}
reformatted_nyc_subway = nyc_subway %>%
  gather(key = route, value = train, route1:route11) %>%
  separate(route, into = c("remove1", "route"), sep = 5) %>%
  select(everything(), -remove1) %>% 
  distinct(line, station_name, train, ada) %>% 
  filter(train == "A")
 
nrow(reformatted_nyc_subway)

sum(reformatted_nyc_subway$ada)
```
_The number of distinct stations that serve the A train is `r nrow(reformatted_nyc_subway)` and `r sum(reformatted_nyc_subway$ada)` are ADA compliant._



### Problem 2

Loading, reading and cleaning dataset
```{r}
trash_wheel = readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = "Mr. Trash Wheel", range = "A2:N258") %>%
janitor::clean_names(dat = .) %>%
  filter(!is.na(dumpster)) %>%
  mutate(sports_balls = as.integer(sports_balls))
```

Reading and cleaning 2016 and 2017 precipitation data
```{r}
precipitation_2016 = readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = "2016 Precipitation", range = "A2:B14") %>%
  janitor::clean_names(dat = .) %>%
  mutate(year = 2016) 

precipitation_2017 = readxl::read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = "2017 Precipitation", range = "A2:B14") %>%  
  janitor::clean_names(dat = .) %>%
  mutate(year = 2017) %>%
    filter(!is.na(total))
```

Combining the two (2016 and 2017) datasets
```{r}
precipitation_2016_2017 = bind_rows(precipitation_2016, precipitation_2017)

month_vector =  month.name[c(pull(precipitation_2016_2017, month))]
 
month_df = tibble::as.tibble(month_vector) 

final_precipitation_2016_2017 = bind_cols(precipitation_2016_2017, month_df) %>%
  select(-month) %>%
  select(year, month = value, total)
```

Median number of sports balls in a dumpster in 2016
```{r}
median_balls_2016 = trash_wheel %>% 
  filter(year == 2016) 
```

_Mr. Trash Wheel dataset has information on a water wheel waste collector and it comprise of `r nrow(trash_wheel)` rows x r `r ncol(trash_wheel)` and this was observed after data cleaning. The key variables in the dataset include: dates (month, year, date) of trash collection, weight/volume (weight_tons, volume_cubic_yards) of trash collected and the types of trash collected (plastic_bottles, glass_bottles, grocery_bags, sports_balls, chip_bags)._

_The 2016 and 2017 dataset contains information on precipitation (total variable) measurements for each month (month variable) in 2016 and 2017. For the 2016 precipitation dataset, there are `r nrow(precipitation_2016)` rows and `r ncol(precipitation_2016)`. For the 2017 precipitation dataset, there are `r nrow(precipitation_2017)` rows and `r ncol(precipitation_2017)` columns._

_The total precipitation in 2017 was `r sum(precipitation_2017$total)` and the median number of sports balls was `r median(median_balls_2016$sports_balls)`_


### Problem 3

Loading dataset
```{r}
devtools::install_github("p8105/p8105.datasets")

library(p8105.datasets)

data(brfss_smart2010)
```

Cleaning dataset and data wrangling
```{r}
brfss_data = janitor::clean_names(dat = brfss_smart2010) %>%
  filter(topic == "Overall Health") %>%
  select(-(class:question), -sample_size, -(confidence_limit_low:geo_location)) %>%
  spread(key = response, value = data_value) %>%
  janitor::clean_names(dat = .) %>%   
mutate(excellent_verygood = excellent + very_good)
```

Questions 
```{r}
nrow(distinct(brfss_data, locationabbr))

most_observed_state = count(brfss_data, locationabbr) %>%
  top_n(1, n) 

pull(most_observed_state, locationabbr)   

pull(most_observed_state, n)
```
_The dataset has `r nrow(distinct(brfss_data, locationabbr))` unique locations. Yes, every state is represented in the dataset. It also contains the federal district of the United States, District of Columbia_

_The state that is observed the most is `r pull(most_observed_state, locationabbr)` and it is observed, having `r pull(most_observed_state, n)`counties._


```{r}
bdata_2002 = brfss_data %>% 
  filter(year == 2002)

median(bdata_2002$excellent, na.rm = TRUE) 
```
_In 2002, the median value of the "Excellent" response value is `r median(bdata_2002$excellent, na.rm = TRUE)`_


Plots 

_Histogram_
```{r}
ggplot(bdata_2002, aes(x = excellent)) + 
  geom_histogram(binwidth = 0.5)
```

_Scatterplot_
```{r}
brfss_data %>% 
  filter(locationdesc %in% c("NY - New York County", "NY - Queens County"), year %in% c("2002":"2012")) %>% 
  ggplot(aes(x = year, y = excellent, color = locationdesc)) +
  geom_point() +
scale_x_continuous(breaks = c(2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010))
```


